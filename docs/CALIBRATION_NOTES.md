# PRODUCTION CALIBRATION NOTES

## ‚ö†Ô∏è WEIGHTED OFI - –ê–ì–†–ï–°–°–ò–í–ù–û–°–¢–¨ –ó–ê–¢–£–•–ê–ù–ò–Ø

**–ò—Å—Ç–æ—á–Ω–∏–∫:** Gemini AI Validation (Weighted OFI Implementation Review)  
**–î–∞—Ç–∞:** 2025-12-29  
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** HIGH (–≤–ª–∏—è–µ—Ç –Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–π—Å–±–µ—Ä–≥–æ–≤)

---

## –ü–†–û–ë–õ–ï–ú–ê

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `calculate_ofi(use_weighted=True)` –≤ `domain.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é —Ñ–æ—Ä–º—É–ª—É –∑–∞—Ç—É—Ö–∞–Ω–∏—è:

```python
lambda_decay_scaled = lambda_decay * 100.0
weight = exp(-lambda_decay_scaled * distance_pct)
```

### –ß–∏—Å–ª–µ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä (BTC, Œª=0.1):

| Distance –æ—Ç mid | distance_pct | Exponent | Weight | –®—Ç—Ä–∞—Ñ |
|-----------------|--------------|----------|--------|-------|
| 0.1% (10 bps)   | 0.1          | -1.0     | 0.36   | 64%   |
| 0.5%            | 0.5          | -5.0     | 0.0067 | 99.3% |
| 1.0%            | 1.0          | -10.0    | 0.00005| 99.995%|

**–†–ò–°–ö:**
- –û—Ä–¥–µ—Ä –≤—Å–µ–≥–æ –≤ **0.1% –æ—Ç mid-price** (–±–ª–∏–∑–∫–æ –∫ —Å–ø—Ä–µ–¥—É!) –ø–æ–ª—É—á–∞–µ—Ç —à—Ç—Ä–∞—Ñ **64%**
- –î–ª—è BTC —Å —Ç–∏–ø–∏—á–Ω—ã–º —Å–ø—Ä–µ–¥–æ–º 0.01-0.05% —ç—Ç–æ –º–æ–∂–µ—Ç –æ—Ç—Å–µ–∫–∞—Ç—å **–†–ï–ê–õ–¨–ù–£–Æ** –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –º–∞—Ä–∫–µ—Ç-–º–µ–π–∫–µ—Ä–æ–≤
- OFI –º–µ—Ç—Ä–∏–∫–∏ —Å—Ç–∞–Ω—É—Ç "—Ç–∏—Ö–∏–º–∏" - –Ω–µ –±—É–¥—É—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

---

## –†–ï–®–ï–ù–ò–Ø (–≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω–æ)

### ‚úÖ –í–ê–†–ò–ê–ù–¢ 1: –£–º–µ–Ω—å—à–∏—Ç—å Œª –≤ config.py (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–§–∞–π–ª:** `config.py`

```python
# BTC_CONFIG
lambda_decay: float = 0.01  # –ë—ã–ª–æ: 0.1 (10x –º—è–≥—á–µ)
```

**–≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ Œª=0.01:**
- Distance 0.1% ‚Üí weight = 0.90 (—à—Ç—Ä–∞—Ñ 10%) ‚úÖ
- Distance 0.5% ‚Üí weight = 0.61 (—à—Ç—Ä–∞—Ñ 39%)
- Distance 1.0% ‚Üí weight = 0.37 (—à—Ç—Ä–∞—Ñ 63%)

**–ü–ª—é—Å—ã:**
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –±–ª–∏–∑–∫–æ –∫ —Å–ø—Ä–µ–¥—É
- –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–ø—É—Ñ—ã –¥–∞–ª–µ–∫–æ –æ—Ç —Ü–µ–Ω—ã (>1%)

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–æ –∫–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ

---

### ‚öôÔ∏è –í–ê–†–ò–ê–ù–¢ 2: –£–±—Ä–∞—Ç—å –º–Ω–æ–∂–∏—Ç–µ–ª—å √ó100

**–§–∞–π–ª:** `domain.py` (—Å—Ç—Ä–æ–∫–∞ ~1529)

```python
# –ë–´–õ–û:
lambda_decay_scaled = lambda_decay * 100.0

# –°–¢–ê–õ–û:
lambda_decay_scaled = lambda_decay  # –£–±—Ä–∞–ª–∏ √ó100
```

**–≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ Œª=0.1 –ë–ï–ó √ó100:**
- Distance 0.1% ‚Üí weight = 0.99 (—à—Ç—Ä–∞—Ñ 1%) ‚úÖ
- Distance 0.5% ‚Üí weight = 0.95 (—à—Ç—Ä–∞—Ñ 5%)
- Distance 1.0% ‚Üí weight = 0.90 (—à—Ç—Ä–∞—Ñ 10%)

**–ü–ª—é—Å—ã:**
- –û—á–µ–Ω—å –º—è–≥–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ (HFT)

**–ú–∏–Ω—É—Å—ã:**
- –ú–æ–∂–µ—Ç **–ù–ï** –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ø—É—Ñ—ã –Ω–∞ 1-2% –æ—Ç mid
- –¢—Ä–µ–±—É–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å Œª (0.5-1.0) –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

---

### üî¨ –í–ê–†–ò–ê–ù–¢ 3: –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ (Advanced)

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ Œª –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–æ–Ω –≥–ª—É–±–∏–Ω—ã:

```python
if distance_pct < 0.2:  # –ë–ª–∏–∑–∫–æ –∫ —Å–ø—Ä–µ–¥—É
    lambda_scaled = lambda_decay * 10.0  # –ú—è–≥–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
else:  # –î–∞–ª–µ–∫–æ –æ—Ç —Å–ø—Ä–µ–¥–∞ (—Å–ø—É—Ñ—ã)
    lambda_scaled = lambda_decay * 100.0  # –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è
```

**–ü–ª—é—Å—ã:**
- –õ—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –º–∏—Ä–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- –°–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å
- –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤

---

## –ú–ï–¢–†–ò–ö–ò –î–õ–Ø –ö–ê–õ–ò–ë–†–û–í–ö–ò

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è Œª **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

### 1. **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å OFI**
```python
# –í –ª–æ–≥–∞—Ö TradingEngine
print(f"OFI (weighted): {ofi_weighted:.2f}")
```

**–•–æ—Ä–æ—à–æ:** OFI —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞–∫–∞–Ω–∞ (¬±1-10 BTC)  
**–ü–ª–æ—Ö–æ:** OFI –≤—Å–µ–≥–¥–∞ –±–ª–∏–∑–æ–∫ –∫ 0 (–º–µ—Ç—Ä–∏–∫–∞ "–º—ë—Ä—Ç–≤–∞—è")

### 2. **–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ü–µ–Ω–æ–π**
```python
# –í analyze_iceberg_context()
correlation = np.corrcoef(ofi_history, price_changes)[0,1]
```

**–•–æ—Ä–æ—à–æ:** |correlation| > 0.3 (OFI –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ)  
**–ü–ª–æ—Ö–æ:** |correlation| < 0.1 (OFI –Ω–µ —Å–≤—è–∑–∞–Ω —Å —Ü–µ–Ω–æ–π)

### 3. **–î–µ—Ç–µ–∫—Ü–∏—è –∞–π—Å–±–µ—Ä–≥–æ–≤**
```python
# –í IcebergAnalyzer
print(f"Detected icebergs: {len(detected)} per hour")
```

**–•–æ—Ä–æ—à–æ:** 5-20 –∞–π—Å–±–µ—Ä–≥–æ–≤/—á–∞—Å (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ –¥–ª—è BTC)  
**–ü–ª–æ—Ö–æ:** 0-1 –∞–π—Å–±–µ—Ä–≥/—á–∞—Å (—Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)

---

## –ò–°–¢–û–†–ò–ß–ï–°–ö–ê–Ø –°–ü–†–ê–í–ö–ê

**2025-12-29:** –ò–∑–Ω–∞—á–∞–ª—å–Ω–∞—è –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `√ó100` –¥–ª—è "—Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–ø—É—Ñ–∏–Ω–≥–∞"  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –î–æ–∫—É–º–µ–Ω—Ç "–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å–º–∞—Ä—Ç-–º–∞–Ω–∏ –¥–ª—è —Ç—Ä–µ–π–¥–∏–Ω–≥–∞" (—Ä–∞–∑–¥–µ–ª 3.2 OBI)

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–ª OBI (Order Book Imbalance), –∞ –Ω–µ OFI (Order Flow Imbalance)  
- OBI - —Å—Ç–∞—Ç–∏—á–Ω—ã–π —Å–Ω–∏–º–æ–∫ —Å—Ç–∞–∫–∞–Ω–∞ (–Ω—É–∂–Ω–∞ –º—è–≥–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
- OFI - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∑–¥–µ—Å—å √ó100 –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –∂—ë—Å—Ç–∫–æ)

**–í—ã–≤–æ–¥:** –§–æ—Ä–º—É–ª—ã OBI –∏ OFI –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å **—Ä–∞–∑–Ω—ã–µ** Œª!

---

## –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –ó–ù–ê–ß–ï–ù–ò–Ø –ü–û –¢–û–ö–ï–ù–ê–ú

| –¢–æ–∫–µ–Ω | Œª (OBI) | Œª (OFI) | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|-------|---------|---------|-------------|
| BTC   | 0.10    | 0.01-0.02 | –£–∑–∫–∏–µ —Å–ø—Ä–µ–¥—ã, –≤—ã—Å–æ–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å |
| ETH   | 0.15    | 0.02-0.03 | –ß—É—Ç—å —à–∏—Ä–µ —Å–ø—Ä–µ–¥—ã |
| SOL   | 0.20    | 0.03-0.05 | –ë–æ–ª–µ–µ –≤–æ–ª–∞—Ç–∏–ª–µ–Ω |

---

## ‚öôÔ∏è VOLUME-BASED OFI - TARGET VOLUME MULTIPLIER

**–ò—Å—Ç–æ—á–Ω–∏–∫:** Gemini AI Validation (Volume-Based OFI Implementation Review)  
**–î–∞—Ç–∞:** 2025-12-31  
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** MEDIUM (–≤–ª–∏—è–µ—Ç –Ω–∞ –≥–ª—É–±–∏–Ω—É –∞–Ω–∞–ª–∏–∑–∞ orderbook)

---

### –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

**–§–∞–π–ª:** `analyzers_features.py` - `FeatureCollector._get_volume_ofi()`

```python
target_vol = float(self.order_book.config.spoofing_volume_threshold) * 5.0
```

**–õ–æ–≥–∏–∫–∞:**
- `spoofing_volume_threshold` = —Ä–∞–∑–º–µ—Ä "—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∫—Ä—É–ø–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞"
- –ú–Ω–æ–∂–∏—Ç–µ–ª—å √ó5 = –æ—Ö–≤–∞—Ç –±–ª–∏–∂–∞–π—à–µ–π "–±–æ–µ–≤–æ–π –∑–æ–Ω—ã" –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏

---

### –ü–†–û–ë–õ–ï–ú–ê

#### –î–ª—è BTC (High Liquid):
```python
spoofing_volume_threshold = 20 BTC
target_volume = 20 * 5 = 100 BTC  # ‚ùå –°–õ–ò–®–ö–û–ú –ì–õ–£–ë–û–ö–û!
```

**–†–∏—Å–∫:**
- –û–±—ã—á–Ω–æ –≤ —Ç–æ–ø-10 —Ç–∏–∫–∞—Ö —Å—Ç–∞–∫–∞–Ω–∞ BTC –≤–∏—Å–∏—Ç **10-20 BTC**
- 100 BTC —Å–æ–±–∏—Ä–∞—é—Ç—Å—è **—Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç —Å–ø—Ä–µ–¥–∞** (–º–æ–∂–µ—Ç —É—Ö–æ–¥–∏—Ç—å –Ω–∞ 0.5-1% –æ—Ç mid)
- Volume OFI –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å "–º—ë—Ä—Ç–≤—É—é" –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å (—Å–ø—É—Ñ—ã –Ω–∞ –≥–ª—É–±–∏–Ω–µ)

#### –î–ª—è SOL (Low Liquid):
```python
spoofing_volume_threshold = 4000 SOL
target_volume = 4000 * 5 = 20,000 SOL  # ‚úÖ –û–ü–†–ê–í–î–ê–ù–û
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –°—Ç–∞–∫–∞–Ω SOL "–∂–∏–¥–∫–∏–π" –∏ –¥—ã—Ä—è–≤—ã–π (–º–Ω–æ–≥–æ –ø—É—Å—Ç—ã—Ö —É—Ä–æ–≤–Ω–µ–π)
- –ú–Ω–æ–∂–∏—Ç–µ–ª—å √ó5 –∏–ª–∏ √ó10 –Ω—É–∂–µ–Ω —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —Ä–µ–∞–ª—å–Ω–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏

---

### –†–ï–®–ï–ù–ò–ï

#### ‚úÖ GEMINI –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø (2025-12-31)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:**
> "–≠–≤—Ä–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏–µ–º–ª–µ–º–∞—è, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è –¥–ª—è '–∫–∏—Ç–æ–≤'."

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏:**

| –¢–æ–∫–µ–Ω | –¢–µ–∫—É—â–∏–π | –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|-------|---------|-------------|-------------|
| **BTC** | √ó5 (100 BTC) | **√ó2 –∏–ª–∏ √ó3** (40-60 BTC) | High Liquid: –¢–æ–ø-10 —Ç–∏–∫–æ–≤ = 10-20 BTC, –º–Ω–æ–∂–∏—Ç–µ–ª—å √ó5 —Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–∏–π |
| **ETH** | √ó5 | **√ó2 –∏–ª–∏ √ó3** | –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ BTC (–≤—ã—Å–æ–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å) |
| **SOL** | √ó5 (20k SOL) | **√ó5 –∏–ª–∏ √ó10** | Low Liquid: –°—Ç–∞–∫–∞–Ω –¥—ã—Ä—è–≤—ã–π, –Ω—É–∂–Ω–∞ –±–æ–ª—å—à–∞—è –≥–ª—É–±–∏–Ω–∞ |

---

### DECISION (Gemini)

> "–û—Å—Ç–∞–≤—å—Ç–µ √ó5 –¥–ª—è —Å—Ç–∞—Ä—Ç–∞. ML (Feature Importance) —Å–∞–º–∞ –ø–æ–∫–∞–∂–µ—Ç, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —ç—Ç–æ.  
> –ï—Å–ª–∏ —Ñ–∏—á–∞ –±—É–¥–µ—Ç —Å–ª–∞–±–æ–π ‚Äî —É–º–µ–Ω—å—à–∏—Ç–µ –º–Ω–æ–∂–∏—Ç–µ–ª—å."

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1. **–°—Ç–∞—Ä—Ç:** –°–æ–±—Ä–∞—Ç—å 1-2 –º–µ—Å—è—Ü–∞ ML –¥–∞–Ω–Ω—ã—Ö —Å —Ç–µ–∫—É—â–∏–º √ó5
2. **–ê–Ω–∞–ª–∏–∑:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Feature Importance –¥–ª—è `ofi_volume`
3. **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞:** –ï—Å–ª–∏ `ofi_volume` —Å–ª–∞–±–∞—è ‚Üí —É–º–µ–Ω—å—à–∏—Ç—å –º–Ω–æ–∂–∏—Ç–µ–ª—å –¥–ª—è BTC/ETH –¥–æ √ó2-√ó3
4. **Backtest:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

---

### –ú–ï–¢–†–ò–ö–ò –î–õ–Ø –ö–ê–õ–ò–ë–†–û–í–ö–ò

#### 1. Feature Importance (ML –º–æ–¥–µ–ª—å)
```python
# –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è XGBoost/RandomForest
importances = model.feature_importances_
ofi_volume_rank = np.where(feature_names == 'ofi_volume')[0]
```

**–•–æ—Ä–æ—à–æ:** `ofi_volume` –≤ —Ç–æ–ø-10 —Ñ–∏—á (–≤–∞–∂–Ω–æ—Å—Ç—å >5%)  
**–ü–ª–æ—Ö–æ:** `ofi_volume` –≤ —Ö–≤–æ—Å—Ç–µ (–≤–∞–∂–Ω–æ—Å—Ç—å <2%) ‚Üí —É–º–µ–Ω—å—à–∏—Ç—å –º–Ω–æ–∂–∏—Ç–µ–ª—å

#### 2. Correlation —Å —Ü–µ–Ω–æ–π
```python
corr = np.corrcoef(ofi_volume_series, price_change_series)[0,1]
```

**–•–æ—Ä–æ—à–æ:** |correlation| > 0.2  
**–ü–ª–æ—Ö–æ:** |correlation| < 0.1 ‚Üí –º–Ω–æ–∂–∏—Ç–µ–ª—å –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —à—É–º

#### 3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
```python
print(f"OFI_volume mean: {ofi_volume.mean():.2f}")
print(f"OFI_volume std: {ofi_volume.std():.2f}")
```

**–•–æ—Ä–æ—à–æ:** Mean ‚â† 0, Std > 1 (–º–µ—Ç—Ä–∏–∫–∞ –¥–∏–Ω–∞–º–∏—á–Ω–∞—è)  
**–ü–ª–æ—Ö–æ:** Mean ‚âà 0, Std < 0.5 (–º–µ—Ç—Ä–∏–∫–∞ "–º—ë—Ä—Ç–≤–∞—è", –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è)

---

### –ü–†–ò–ú–ï–† –ö–ê–õ–ò–ë–†–û–í–ö–ò (–ü–æ—Å–ª–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö)

```python
# config.py - AssetConfig –¥–ª—è BTC

class AssetConfig(BaseModel):
    # ... (–¥—Ä—É–≥–∏–µ –ø–æ–ª—è)
    
    # NEW: –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
    volume_ofi_multiplier: float = Field(
        default=5.0,
        description="–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–ª—è target_volume –≤ Volume-Based OFI"
    )

# –ü—Ä–∏–º–µ—Ä—ã –ø–æ—Å–ª–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏:
BTC_CONFIG = AssetConfig(
    # ...
    spoofing_volume_threshold=Decimal("20"),
    volume_ofi_multiplier=2.5,  # ‚Üê –û–¢–ö–ê–õ–ò–ë–†–û–í–ê–ù–û: 20*2.5=50 BTC
)

SOL_CONFIG = AssetConfig(
    # ...
    spoofing_volume_threshold=Decimal("4000"),
    volume_ofi_multiplier=7.0,  # ‚Üê –û–¢–ö–ê–õ–ò–ë–†–û–í–ê–ù–û: 4000*7=28k SOL
)
```

---

### –†–ò–°–ö–ò –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ô –ö–ê–õ–ò–ë–†–û–í–ö–ò

**–ú–Ω–æ–∂–∏—Ç–µ–ª—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (√ó10):**
- ‚ùå –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç "–º—ë—Ä—Ç–≤—É—é" –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –¥–∞–ª–µ–∫–æ –æ—Ç —Å–ø—Ä–µ–¥–∞
- ‚ùå OFI –≤–∫–ª—é—á–∞–µ—Ç —Å–ø—É—Ñ—ã (–ª–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã)
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–∫–æ–ª–æ —Å–ø—Ä–µ–¥–∞

**–ú–Ω–æ–∂–∏—Ç–µ–ª—å —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π (√ó1):**
- ‚ùå –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ BBO (Best Bid/Offer) —É—Ä–æ–≤–µ–Ω—å
- ‚ùå –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä—ã—Ç—É—é –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –Ω–∞ 2-3 —Ç–∏–∫–∞—Ö
- ‚ùå OFI —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–∏—à–∫–æ–º "—à—É–º–Ω—ã–º" (—Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –º–µ–ª–∫–∏–π –æ—Ä–¥–µ—Ä)

**–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å:**
- ‚úÖ –ü–æ–∫—Ä—ã–≤–∞–µ—Ç 60-80% —Ä–µ–∞–ª—å–Ω–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –æ–∫–æ–ª–æ —Å–ø—Ä–µ–¥–∞
- ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Å–ø—É—Ñ—ã –Ω–∞ >1% –æ—Ç mid
- ‚úÖ OFI –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –¥–≤–∏–∂–µ–Ω–∏–µ–º —Ü–µ–Ω—ã (|r| > 0.2)

---

## TODO –ü–†–ò –î–ï–ü–õ–û–ï –í PRODUCTION

### Weighted OFI (Lambda Decay)
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫—Ç–µ—Å—Ç –Ω–∞ 7 –¥–Ω—è—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `ofi_weighted` –≤ –ª–æ–≥–∞—Ö (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ¬±1-10 –¥–ª—è BTC)
- [ ] –ò–∑–º–µ—Ä–∏—Ç—å correlation(OFI, price_change) > 0.3
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è 5-20 –∞–π—Å–±–µ—Ä–≥–æ–≤/—á–∞—Å
- [ ] –ï—Å–ª–∏ –º–µ—Ç—Ä–∏–∫–∏ "—Ç–∏—Ö–∏–µ" ‚Üí —É–º–µ–Ω—å—à–∏—Ç—å Œª –¥–æ 0.01

### Volume-Based OFI (Target Volume Multiplier)
- [ ] –°–æ–±—Ä–∞—Ç—å 1-2 –º–µ—Å—è—Ü–∞ ML –¥–∞–Ω–Ω—ã—Ö —Å —Ç–µ–∫—É—â–∏–º √ó5 –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Feature Importance –¥–ª—è `ofi_volume` –≤ ML –º–æ–¥–µ–ª–∏
  - ‚úÖ –•–æ—Ä–æ—à–æ: –¢–æ–ø-10 —Ñ–∏—á (–≤–∞–∂–Ω–æ—Å—Ç—å >5%)
  - ‚ùå –ü–ª–æ—Ö–æ: –•–≤–æ—Å—Ç (–≤–∞–∂–Ω–æ—Å—Ç—å <2%) ‚Üí —É–º–µ–Ω—å—à–∏—Ç—å –º–Ω–æ–∂–∏—Ç–µ–ª—å
- [ ] –ò–∑–º–µ—Ä–∏—Ç—å correlation(ofi_volume, price_change)
  - ‚úÖ –•–æ—Ä–æ—à–æ: |r| > 0.2
  - ‚ùå –ü–ª–æ—Ö–æ: |r| < 0.1 ‚Üí –º–Ω–æ–∂–∏—Ç–µ–ª—å –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —à—É–º
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π `ofi_volume`
  - ‚úÖ –•–æ—Ä–æ—à–æ: Mean ‚â† 0, Std > 1
  - ‚ùå –ü–ª–æ—Ö–æ: Mean ‚âà 0, Std < 0.5 ("–º—ë—Ä—Ç–≤–∞—è" –º–µ—Ç—Ä–∏–∫–∞)
- [ ] –ï—Å–ª–∏ `ofi_volume` —Å–ª–∞–±–∞—è ‚Üí —É–º–µ–Ω—å—à–∏—Ç—å –º–Ω–æ–∂–∏—Ç–µ–ª—å:
  - BTC/ETH: √ó5 ‚Üí √ó2 –∏–ª–∏ √ó3 (40-60 BTC)
  - SOL: –û—Å—Ç–∞–≤–∏—Ç—å √ó5-√ó10
- [ ] Backtest —Å –Ω–æ–≤—ã–º–∏ –º–Ω–æ–∂–∏—Ç–µ–ª—è–º–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏

### Final
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª —Å —Ñ–∏–Ω–∞–ª—å–Ω—ã–º–∏ –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

---

## –ö–û–ù–¢–ê–ö–¢–´

**–í–æ–ø—Ä–æ—Å—ã –ø–æ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å Gemini AI –∏–ª–∏ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ—Å—Ç—ã –≤ `tests/test_weighted_ofi.py`

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-29
